---
import MainLayout from "../../layouts/main-layout.astro";
import { Image } from "astro:assets";
import artwork from "../../../artwork.json";

export async function getStaticPaths() {
    const Images: any = [];

    const images = await Astro.glob("../../assets/showcase/*.png").then(
        async (data) => {
            const clone = [...data];

            await clone.map((img) => {
                const str = img.default.src;
                const regex = import.meta.env.PROD
                    ? /\/(\d+)-([^\/]+)\.\w+$/
                    : /\/(\d+)-(.+)\.png\?/;
                const match = str.match(regex);
                const number = Number(match[1]);
                const text = match[2];

                Images.push({
                    ...img,
                    title: import.meta.env.PROD
                        ? text.replace(/\..*/, "")
                        : text,
                    id: number,
                });
            });

            return data;
        }
    );

    return Images.map((img) => {
        return {
            params: { slug: img.title },
            props: { image: img },
        };
    });
}

const { image } = Astro.props;

const artWork = artwork.find((art) => art.name.toLowerCase() === image.title.toLowerCase());
---

<MainLayout title={image.title.replaceAll("-", " ")}>
    <div class="flex flex-col lg:flex-row gap-2 justify-between">
        <div class="overflow-hidden rounded-lg">
            <Image
                id="image"
                src={image.default.src}
                alt={image.title}
                width={1920}
                height={1080}
                loading="eager"
            />
        </div>

        <div
            class="bg-secondary p-4 flex flex-col gap-2 flex-shrink-0 mb-auto rounded-md"
        >
            <div class="bg-primary p-4">
                <h3 class="font-extrabold text-2xl">Name</h3>
                <span>{artWork?.name.replaceAll("-", " ").toUpperCase()}</span>
            </div>
            <div class="bg-primary p-4">
                <h3 class="font-extrabold text-2xl">Creation Date</h3>
                <span>{artWork?.date}</span>
            </div>
            <div class="bg-primary p-4">
                <h3 class="font-extrabold text-2xl">Description</h3>
                <span>{artWork?.description}</span>
            </div>
        </div>
    </div>
</MainLayout>
